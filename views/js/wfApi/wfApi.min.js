
const URI=URI||{'LABEL':'http://www.w3.org/2000/01/rdf-schema#label','ENDORSMENT':'##NAMESPACE#ENDORSMENT','SUBJECT':'http://www.tao.lu/Ontologies/TAOSubject.rdf#Subject','SUBJETC_LOGIN':'http://www.tao.lu/Ontologies/generis.rdf#login','SUBJETC_FIRSTNAME':'http://www.tao.lu/Ontologies/generis.rdf#userFirstName','SUBJETC_LASTNAME':'http://www.tao.lu/Ontologies/generis.rdf#userLastName','ITEM':'http://www.tao.lu/Ontologies/TAOItem.rdf#Item','PROCESS':'http://www.tao.lu/middleware/taoqual.rdf#i119010455660544','TEST':'http://www.tao.lu/Ontologies/TAOTest.rdf#Test','DELIVERY':'http://www.tao.lu/Ontologies/TAODelivery.rdf#Delivery'};const STATE=STATE||{'ITEM':{'FINISHED':'item_finished'}}
function RecoveryContext(){var _recoveryCtx=this;this.registry=null;this.sourceService={type:'sync',data:null,url:'/wfEngine/Context/retrieve',params:{},method:'post',format:'json'};this.destinationService={url:'/wfEngine/Context/save',params:{},method:'post',format:'json',flush:true};this.initSourceService=function(environment){if($.isPlainObject(environment)){if($.inArray(environment.type,['manual','sync','async'])>-1){this.sourceService.type=environment.type;if(this.sourceService.type=='manual'&&$.isPlainObject(environment.data)){this.sourceService.data=environment.data;}
else{if(source.url){if(/(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/.test(environment.url)){this.sourceService.url=environment.url;}}
if($.isPlainObject(environment.params)){for(key in environment.params){if(isScalar(environment.params[key])){this.sourceService.params[key]=environment.params[key];}}}
if(environment.method){if(/^get|post$/i.test(environment.method)){this.sourceService.method=environment.method;}}}}}};this.retrieveContext=function(){switch(this.sourceService.type){case'manual':this.registry=this.sourceService.data;break;case'sync':this.registry=$.parseJSON($.ajax({async:false,url:this.sourceService.url,data:this.sourceService.params,type:this.sourceService.method}).responseText);break;case'async':$.ajax({async:false,url:this.sourceService.url,data:this.sourceService.params,type:this.sourceService.method,success:function(received){this.registry=received;}});break;}};this.initDestinationService=function(environment){if($.isPlainObject(environment)){if(environment.url){if(/(\/[-a-z\d%_.~+]*)*(\?[;&a-z\d%_.~+=-]*)?(\#[-a-z\d_]*)?$/.test(environment.url)){this.destinationService.url=environment.url;}}
if($.isPlainObject(environment.params)){for(key in environment.params){if(isScalar(environment.params[key])){this.destinationService.params[key]=environment.params[key];}}}
if(environment.method){if(/^get|post$/i.test(environment.method)){this.destinationService.method=environment.method;}}}};this.saveContext=function(){var parameters=this.destinationService.params;parameters['context']=this.registry;$.ajax({async:(this.destinationService.type=='async'),url:this.destinationService.url,data:parameters,type:this.destinationService.method,success:function(data){if(data.saved){if(_recoveryCtx.destinationService.flush){this.registry=new Object();}}}});};this.getContext=function(key){if(this.registry==null){this.retrieveContext();}
return(this.registry[key])?this.registry[key]:false;};this.setContext=function(key,value){this.registry[key]=value;};}
var wfApi={'context':window.top.document};function forward(){wfApi.context.getElementById('next').click();}
function backward(){wfApi.context.getElementById('back').click();}
function pause(){wfApi.context.getElementById('pause').click();}
if(typeof(finish)!='function'){function finish(){$(window).trigger(STATE.ITEM.FINISHED);}
function onFinish(callback){$(window).bind(STATE.ITEM.FINISHED,callback);}}
$(window).bind(STATE.ITEM.FINISHED,forward);var recoveryCtx=new RecoveryContext();function initRecoveryContext(source,destination){recoveryCtx.initSourceService(source);recoveryCtx.initDestinationService(destination);}
function getRecoveryContext(key){return recoveryCtx.getContext(key);}
function setRecoveryContext(key,data){recoveryCtx.setContext(key,data);recoveryCtx.saveContext();}
function deleteRecoveryContext(key){setRecoveryContext(key,null);}